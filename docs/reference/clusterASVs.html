<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cluster ASVs into Clusters — clusterASVs • biomeUtils</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cluster ASVs into Clusters — clusterASVs" />
<meta property="og:description" content="Cluster ASVs into Clusters" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biomeUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.015</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RIVM-IIV-Microbiome/biomeUtils/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cluster ASVs into Clusters</h1>
    <small class="dont-index">Source: <a href='https://github.com/RIVM-IIV-Microbiome/biomeUtils/blob/master/R/clusterASVs.R'><code>R/clusterASVs.R</code></a></small>
    <div class="hidden name"><code>clusterASVs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cluster ASVs into Clusters</p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A phyloseq object</p></td>
    </tr>
    <tr>
      <th>cluster_method</th>
      <td><p>See methods in <code><a href='https://rdrr.io/pkg/DECIPHER/man/IdClusters.html'>IdClusters</a></code>
in <code>DECIPHER</code>
Default is "inexact"</p></td>
    </tr>
    <tr>
      <th>cluster_cutoff</th>
      <td><p>Cut-off for clustering ASVs.
Default= 0.01 i.e. 99 percent identity</p></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p>No. of processors to use</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A new <code>phyloseq</code> object with cluster ASVs</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>clusterASVs clusters ASV sequences
         obtained after <code>dada2</code> in <code>phyloseq</code> object into clusters
         based on user provided sequence identity. If using method="inexact"
         this is similar to OTU approach for example clustering of ASVs that
         are 97<!-- % similar into one operational taxonomic unit. While preference -->
         for ASVs or OTUs is highly debated (see reference section), both
         have their pros and cons.The user is advised to make appropriate
         choice based on their research questions and properties of data.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Clustering ASVs after DADA2? generating new OTU table.
       <em>GitHub issue #947:</em>
       <a href='https://github.com/benjjneb/dada2/issues/947'>https://github.com/benjjneb/dada2/issues/947</a></p></li>
<li><p>Michael McLaren. mikemc/speedyseq: speedyseq v0.2.0.
        <em>Zenodo</em>, 2020, June 30, (Version v0.2.0).
        <a href='http://doi.org/10.5281/zenodo.3923184'>http://doi.org/10.5281/zenodo.3923184</a></p></li>
<li><p>PD Schloss. Pre-print Review of 97<!-- % Identity Threshold Manuscript. -->
        <em>Blogpost: The Academic Hermit</em>, 2017, Oct 11.
        <a href='http://www.academichermit.com/2017/10/11/Review-of-Updating-the-97-identity-threshold.html'>http://www.academichermit.com/2017/10/11/Review-of-Updating-the-97-identity-threshold.html</a></p></li>
<li><p>Angela Oliverio and Noah Fierer. Intragenomic heterogeneity and its
        implications for ESVs.
        <em>Blogpost: Fierer Lab</em>, 2017, Oct 9.
        <a href='http://fiererlab.org/2017/10/09/intragenomic-heterogeneity-and-its-implications-for-esvs/'>http://fiererlab.org/2017/10/09/intragenomic-heterogeneity-and-its-implications-for-esvs/</a></p></li>
<li><p>Noah Fierer, Tess Brewer, and Mallory Choudoir. Lumping versus
        splitting – is it time for microbial ecologists to abandon OTUs?.
        <em>Blogpost: Fierer Lab</em>, 2017, May 2.
        <a href='http://fiererlab.org/2017/05/02/lumping-versus-splitting-is-it-time-for-microbial-ecologists-to-abandon-otus/'>http://fiererlab.org/2017/05/02/lumping-versus-splitting-is-it-time-for-microbial-ecologists-to-abandon-otus/</a></p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sudarshan A. Shetty</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>biomeUtils</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'data.table'</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:dplyr':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    between, first, last</span></div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tibble.tidyverse.org/'>tibble</a></span><span class='op'>)</span>

<span class='va'>testSprockett</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/microbiome/man/core.html'>core</a></span><span class='op'>(</span><span class='fu'>subset_samples</span><span class='op'>(</span><span class='va'>SprockettTHData</span>, <span class='va'>Community</span> <span class='op'>==</span> <span class='st'>"River_4"</span><span class='op'>)</span>, <span class='fl'>5</span>, <span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>testSprockett</span> <span class='op'>&lt;-</span> <span class='fu'>clusterASVs</span><span class='op'>(</span><span class='va'>testSprockett</span>,
                             cluster_method <span class='op'>=</span> <span class='st'>"NJ"</span>,
                             cluster_cutoff <span class='op'>=</span> <span class='fl'>0.01</span>,
                             threads <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Determining distance matrix based on shared 8-mers:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.03 secs
#&gt; 
#&gt; Clustering into groups by similarity:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.02 secs
#&gt; 
#&gt; Aligning Sequences:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 1.75 secs
#&gt; 
#&gt; Iteration 1 of 2:
#&gt; 
#&gt; Determining distance matrix based on alignment:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.01 secs
#&gt; 
#&gt; Reclustering into groups by similarity:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.02 secs
#&gt; 
#&gt; Realigning Sequences:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 1.11 secs
#&gt; 
#&gt; Iteration 2 of 2:
#&gt; 
#&gt; Determining distance matrix based on alignment:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.01 secs
#&gt; 
#&gt; Reclustering into groups by similarity:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.02 secs
#&gt; 
#&gt; Realigning Sequences:
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.28 secs
#&gt; 
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.01 secs
#&gt; 
#&gt; ================================================================================
#&gt; 
#&gt; Time difference of 0.01 secs
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sudarshan Shetty, Person Person, Person Person.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


